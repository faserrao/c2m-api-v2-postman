# Validation Reports

This directory contains timestamped validation reports generated by the post-build validation system.

## Report Types

### Validation Reports

**Format**: `validation-YYYYMMDD-HHMMSS.{md,json}`

Consolidated reports from all validation components:
- Secret configuration validation
- Pipeline output validation (OpenAPI, collections, artifacts, docs)
- Mock server verification
- Newman test results

**Generated by**: `scripts/validation/generate_report.py`

**Example**:
```
validation-20251104-143000.md    # Human-readable markdown
validation-20251104-143000.json  # Machine-readable JSON
```

### Newman Test Reports

**Format**: `newman-{collection}-YYYYMMDD-HHMMSS.{html,json,xml}`

Newman test execution results from individual collection runs.

**Generated by**: `scripts/validation/run_newman.sh`

**Example**:
```
newman-c2mapiv2-test-collection-20251104-143000.html
newman-c2mapiv2-test-collection-20251104-143000.json
```

### Mock Verification Reports

**Format**: `mock-verification-YYYYMMDD-HHMMSS.json`

Detailed results from mock server endpoint verification.

**Generated by**: `scripts/validation/verify_mocks.py`

**Example**:
```
mock-verification-20251104-143000.json
```

## Viewing Reports

### Markdown Reports

**Terminal**:
```bash
cat reports/validation-*.md | less
```

**Browser** (via markdown preview):
```bash
open reports/validation-*.md
```

### HTML Reports

**Browser**:
```bash
open reports/newman-*.html
```

### JSON Reports

**Pretty print**:
```bash
cat reports/validation-*.json | jq '.'
```

**Quick summary**:
```bash
cat reports/validation-*.json | jq '.summary'
```

## Report Lifecycle

### Generation

Reports are generated automatically when running validation commands:

```bash
# Generates validation report
make validate-local

# Generates Newman reports
make validate-mocks
```

### Retention

- Reports are **not committed** to git (listed in `.gitignore`)
- Reports are kept **locally** for debugging and analysis
- **Manual cleanup** recommended after 30 days

### Cleanup

**Remove old reports**:
```bash
# Remove reports older than 30 days
find reports/ -name "validation-*.md" -mtime +30 -delete
find reports/ -name "validation-*.json" -mtime +30 -delete
find reports/ -name "newman-*.html" -mtime +30 -delete
find reports/ -name "newman-*.json" -mtime +30 -delete
```

**Remove all reports**:
```bash
# Keep directory structure, remove reports
git clean -fX reports/
```

## CI/CD Integration

### GitHub Actions

Reports are uploaded as workflow artifacts:

```yaml
- name: Upload Validation Reports
  uses: actions/upload-artifact@v4
  with:
    name: validation-reports
    path: reports/
    retention-days: 30
```

### Downloading Artifacts

1. Go to GitHub Actions workflow run
2. Scroll to **Artifacts** section
3. Download `validation-reports.zip`
4. Extract and view reports

## Report Structure

### Validation Report (Markdown)

```markdown
# C2M API V2 - Validation Report

**Date**: 2025-11-04 14:30:00
**Workspace**: Personal
**Build Type**: Local

## Summary

- Total Tests: 156
- Passed: 152
- Failed: 4
- Success Rate: 97.4%

## Secret Configuration YES
- .env file: YES Exists
- API keys: YES Valid
- Workspace: YES Accessible

## Pipeline Outputs YES
- OpenAPI spec: YES Valid
- Collections: YES Generated
- Documentation: YES Built

## Mock Servers WARNING
- Prism: YES 8/9 endpoints passed
- Postman: YES 9/9 endpoints passed

## Details

[Detailed breakdown of all tests...]
```

### Validation Report (JSON)

```json
{
  "timestamp": "2025-11-04T14:30:00",
  "workspace": "personal",
  "build_type": "local",
  "summary": {
    "total_tests": 156,
    "passed": 152,
    "failed": 4,
    "success_rate": 97.4
  },
  "components": {
    "secrets": {
      "status": "passed",
      "tests": 8,
      "passed": 8,
      "failed": 0
    },
    "pipeline": {
      "status": "passed",
      "tests": 42,
      "passed": 40,
      "failed": 2
    },
    "mocks": {
      "status": "warning",
      "tests": 18,
      "passed": 17,
      "failed": 1
    }
  }
}
```

## Troubleshooting

### No reports generated

**Check**:
1. Validation commands ran successfully: `echo $?` (should be 0 or 1)
2. Reports directory exists: `ls -la reports/`
3. Script permissions: `ls -l scripts/validation/generate_report.py`

**Fix**:
```bash
# Create directory
mkdir -p reports

# Make scripts executable
chmod +x scripts/validation/generate_report.py

# Run validation again
make validate-local
```

### Cannot open HTML reports

**macOS**:
```bash
open reports/newman-*.html
```

**Linux**:
```bash
xdg-open reports/newman-*.html
```

**Windows**:
```cmd
start reports/newman-*.html
```

### JSON parsing errors

**Validate JSON**:
```bash
# Check if JSON is valid
cat reports/validation-*.json | jq empty

# If error, check file contents
cat reports/validation-*.json
```

## Related Documentation

- [Validation Summary](../VALIDATION_SUMMARY.md)
- [Validation Implementation Plan](../VALIDATION_IMPLEMENTATION_PLAN.md)
- [Validation Gap Analysis](../VALIDATION_GAP_ANALYSIS.md)
- [Scripts README](../scripts/validation/README.md)

## Support

For issues:
1. Check this README
2. Review validation documentation
3. Check Makefile: `make help | grep validate`
4. Review script documentation: `cat scripts/validation/README.md`
